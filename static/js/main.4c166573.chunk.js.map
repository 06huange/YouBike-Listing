{"version":3,"sources":["Map.js","YouBike.js","App.js","index.js"],"names":["Map","props","className","onClick","handleClose","content","YouBike","useState","error","setError","isLoaded","setIsLoaded","items","setItems","mapLocation","setMapLocation","mapStat","setMapStat","query","setQuery","ref","useRef","isOpen","setIsOpen","mapSource","togglePopup","event","location","stat","currentTarget","classList","remove","addHover","add","removeHover","useEffect","fetch","then","res","json","result","obj","sort","a","b","mday","window","alert","message","id","width","height","src","map","item","snaen","sbi","onMouseEnter","onMouseLeave","tot","convertToDate","sno","input","toFixed","addLeadingZero","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"iLAaeA,EAXH,SAAAC,GACV,OACE,qBAAKC,UAAU,UAAf,SACE,sBAAKA,UAAU,MAAf,UACE,sBAAMA,UAAU,aAAaC,QAASF,EAAMG,YAA5C,eACCH,EAAMI,cCJA,SAASC,IACtB,MAA0BC,mBAAS,MAAnC,mBAAOC,EAAP,KAAcC,EAAd,KACA,EAAgCF,oBAAS,GAAzC,mBAAOG,EAAP,KAAiBC,EAAjB,KACA,EAA0BJ,mBAAS,IAAnC,mBAAOK,EAAP,KAAcC,EAAd,KACA,EAAsCN,mBAAS,SAA/C,mBAAOO,EAAP,KAAoBC,EAApB,KACA,EAA8BR,mBAAS,SAAvC,mBAAOS,EAAP,KAAgBC,EAAhB,KACA,EAA0BV,mBAAS,UAAnC,mBAAOW,EAAP,KAAcC,EAAd,KACMC,EAAMC,iBAAO,MAEnB,EAA4Bd,oBAAS,GAArC,mBAAOe,EAAP,KAAeC,EAAf,KACMC,EAAY,4FAA8FN,EAAQ,UAClHO,EAAc,SAACC,EAAOC,EAAUC,GACpCb,EAAeY,GACfV,EAAWW,GACXT,EAASQ,GACLL,GACFI,EAAMG,cAAcC,UAAUC,OAAO,SAEvCR,GAAWD,IAGPU,EAAW,SAAAN,GACfA,EAAMG,cAAcC,UAAUG,IAAI,UAG9BC,EAAc,SAAAR,GAClBA,EAAMG,cAAcC,UAAUC,OAAO,UA+BvC,OAzBAI,qBAAU,WAIRC,MAAM,2FACHC,MAAK,SAAAC,GAAG,OAAIA,EAAIC,UAChBF,MACC,SAACG,GACC7B,GAAY,GAEZ,IAAI8B,EAAMD,EACVC,EAAIC,MAAK,SAACC,EAAEC,GAAH,OAASA,EAAEC,KAAOF,EAAEE,QAC7BhC,EAAS4B,MAKX,SAACjC,GACCG,GAAY,GACZF,EAASD,GACTsC,OAAOC,MAAM,UAAYvC,EAAMwC,QAAU,0CAG9C,IAECxC,EACK,0CAAaA,EAAMwC,WAChBtC,EAIR,gCACGY,GAAU,cAAC,EAAD,CACTjB,QAAS,qCACP,sBAAK4C,GAAG,mBAAR,UACE,qBAAKA,GAAG,oBAAR,SAA6BnC,IAC7B,sBAAKmC,GAAG,gBAAR,wBAAoCjC,QAEtC,wBACAkC,MAAM,OACNC,OAAO,MACPC,IAAK5B,OAEPpB,YAAaqB,IAEf,oBAAIwB,GAAG,UAAP,SACGrC,EAAMyC,KAAI,SAAAC,GAAI,OACb,oBAAmBnD,QAAS,SAAAuB,GAAK,OAAID,EAAYC,EAAO4B,EAAKC,MAAOD,EAAKE,MAAMC,aAAczB,EAAU0B,aAAcxB,EAArH,SACE,qBAAId,IAAKA,EAAK6B,GAAG,OAAjB,UACI,6BAAKK,EAAKC,QACV,yCAAYD,EAAKK,OACjB,6CAAgBL,EAAKE,OACrB,6BAAKI,EAAcN,EAAKT,YALrBS,EAAKO,aAnBf,6CAoCX,SAASD,EAAcE,GAQnB,OAPYA,EAAQ,MAAaC,QAAQ,GAO3B,IANFC,GAAgBF,EAAQ,KAAWC,QAAQ,GAAK,KAMhC,IALlBC,GAAgBF,EAAQ,KAASC,QAAQ,GAAK,KAKhB,MAH7BC,GAAiBF,EAAQ,IAAS,KAAKC,QAAQ,IAGH,IAF7CC,GAAiBF,EAAQ,IAAO,KAAKC,QAAQ,IAEY,IADzDC,GAAgBF,EAAQ,KAAKC,QAAQ,IAKnD,SAASC,EAAeF,GACpB,OAAGA,EAAQ,GAAK,EACL,IAAMA,EAGNA,E,MC1GAG,MANf,WACE,OACE,cAAC3D,EAAD,KCFJ4D,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.4c166573.chunk.js","sourcesContent":["import React from \"react\";\n \nconst Map = props => {\n  return (\n    <div className=\"map-box\">\n      <div className=\"box\">\n        <span className=\"close-icon\" onClick={props.handleClose}>x</span>\n        {props.content}\n      </div>\n    </div>\n  );\n};\n \nexport default Map;","import React, { useState, useEffect, useRef } from 'react';\nimport Map from './Map';\n\nexport default function YouBike() {\n  const [error, setError] = useState(null);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [items, setItems] = useState([]);\n  const [mapLocation, setMapLocation] = useState('Click');\n  const [mapStat, setMapStat] = useState('Click');\n  const [query, setQuery] = useState('Taipei');\n  const ref = useRef(null);\n\n  const [isOpen, setIsOpen] = useState(false);\n  const mapSource = 'https://www.google.com/maps/embed/v1/place?key=AIzaSyDId7Y0YTgaQiAMczyNPA8OjJevW92Uh8s&q=' + query + ',Taipei';\n  const togglePopup = (event, location, stat) => {\n    setMapLocation(location);\n    setMapStat(stat);\n    setQuery(location);\n    if(!isOpen){\n      event.currentTarget.classList.remove('hover');\n    }\n    setIsOpen(!isOpen);\n  }\n\n  const addHover = event => {\n    event.currentTarget.classList.add('hover');\n  }\n\n  const removeHover = event => {\n    event.currentTarget.classList.remove('hover');\n  }\n  // Note: the empty deps array [] means\n  // this useEffect will run once\n  // similar to componentDidMount()\n\n  useEffect(() => {\n    //https://data.ntpc.gov.tw\n    //* use below proxy server address for local development\n    //http://localhost:8010/proxy/\n    fetch(\"https://data.ntpc.gov.tw/api/datasets/71CD1490-A2DF-4198-BEF1-318479775E8A/json/preview\")\n      .then(res => res.json())\n      .then(\n        (result) => {\n          setIsLoaded(true);\n          //sort Array based on \"mday\"\n          var obj = result;\n          obj.sort((a,b) => b.mday - a.mday);\n          setItems(obj);\n        },\n        // Note: it's important to handle errors here\n        // instead of a catch() block so that we don't swallow\n        // exceptions from actual bugs in components.\n        (error) => {\n          setIsLoaded(true);\n          setError(error);\n          window.alert(\"Error: \" + error.message + \"\\nTry using CORS Chrome extension\")\n        }\n        )\n  }, [])\n\n  if (error) {\n    return <div>Error: {error.message}</div>;\n  } else if (!isLoaded) {\n    return <div>Loading...</div>;\n  } else {\n    return (\n      <div>\n        {isOpen && <Map\n          content={<>\n            <div id=\"mapHeaderWrapper\">\n              <div id=\"mapHeaderLocation\">{mapLocation}</div>\n              <div id=\"mapHeaderStat\">Available: {mapStat}</div>\n            </div>\n            <iframe\n            width=\"1005\"\n            height=\"450\"\n            src={mapSource}></iframe>\n          </>}\n          handleClose={togglePopup}\n        />}\n        <ul id=\"listing\">\n          {items.map(item => (\n            <li key={item.sno} onClick={event => togglePopup(event, item.snaen, item.sbi)} onMouseEnter={addHover} onMouseLeave={removeHover}>\n              <ul ref={ref} id=\"item\">\n                  <li>{item.snaen}</li>\n                  <li>Total: {item.tot}</li>\n                  <li>Available: {item.sbi}</li>\n                  <li>{convertToDate(item.mday)}</li>\n              </ul>\n            </li>\n          ))}\n        </ul>\n      </div>\n    );\n  }\n}\n\n//convert number to Date Format\n//20210516154847 -> 2021/05/16 15:48:47\nfunction convertToDate(input){\n    var year = (input / 10000000000).toFixed(0);\n    var month = addLeadingZero((input / 100000000).toFixed(0) % 100);\n    var day = addLeadingZero((input / 1000000).toFixed(0) % 100);\n\n    var hour = addLeadingZero(((input / 10000) % 100).toFixed(0));\n    var min = addLeadingZero(((input / 100) % 100).toFixed(0));\n    var sec = addLeadingZero((input % 100).toFixed(0));\n    return(year + \"/\" + month + \"/\" + day + \" - \" + hour + \":\" + min + \":\" + sec);\n}\n\n//helper function to add leading zero for fixed numeric format\nfunction addLeadingZero(input){\n    if(input / 10 < 1){\n        return(\"0\" + input)\n    }\n    else{\n        return input;\n    }\n}\n","import React from 'react'\nimport YouBike from './YouBike'\nimport './styles.css'\n\nfunction App() {\n  return (\n    <YouBike />\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n\n\n"],"sourceRoot":""}